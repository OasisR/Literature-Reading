## 第一部分

1. 从$P_T(Y) = \sum P_T(Y| X,T)P(X)P(T|X)$到$P_T(Y) = \sum P_T(Y| X,T)P(X)$

2. 最朴实的方法，控制每一个x；
   + 有向无环图
   + 我对这个病人，是否治疗，最终会有什么差别（做差的结果）——但是一个人不能同时治疗又同时不治疗
   + 我拿到数据，但是我只有两列值——是否治疗和结果——但是每个人的x是不一样的（个人情况考虑进去就是那个X）
   + 当我的X是一个超级高维的情况，我就不能直接分来了（正如假设只有二值，就直接分成男的，女的了——但不可能，维数太低了）
   + 同样是一个T(💊)，但是我每个人不同X，身体状况不相同，最终得到的结果是不一样的
3. 推理
   + 太阳出来鸡打鸣，但是杀了鸡太阳就不出来了？因果关系和相关关系是无关的
4. 多引入一个变量，直接通过数量来记，尤其是数量特别不平衡的时候，会导致不对的结果（simpson悖论）
5. 贝叶斯是一个求和，但是如果我已经知道了倒数第二步的结果（知道了额外的信息），我就没有必要再对倒数第二步之前的东西进行建模，可以直接知道了
   + 先乘再加——全概率公式
6. **这篇论文：能够把弱的伪关系去掉（backdoor）**
   + 有一些基因很重要，但是我没看到，虽然我观察到了样本，但是有的样本的特征我没观察到（有些特征也根本无法观测到）（or隐特征）——如果他们的关联不够强，还是有可能解决的
   + 如何得到我做的这件事的后果是好的还是坏的？
7. 样本：一个人，要么属于控制组，要么属于治疗组（是一个划分）——这种情况下如何判断治疗效果？
   + 判断**受到治疗的人**有什么效果？
   + 给他药之后他的结果是可以观测到的，但是这样不给他药的时候受到的治疗效果就不知道了（**反事实推理**，历史的选择）
   + 把所有接受治疗的人都扔进来——避免一个人的各种随机因素
   + 分支：生物医药、金融、社会学模型
8. 原来要做什么？
   + 随机化研究
   + 什么是一个好的实验？——希望达到的目的——没有这个后门了
     + 随机给药，独立$W_{i} \perp\left(Y_{i}(0), Y_{i}(1)\right)$ （那个独立符号，也代表有向图中这个部分是断掉的）
     + 吃了药以后的效果 和 吃不吃药无关
   + 当然纯理想的上述实验达不到——但是可以在给定x的情况下进一步
     + *Assumption 1* (unconfoundedness). $W_{i} \perp\left(Y_{i}(0), Y_{i}(1)\right) | X_{i}$
       + 其实是说知道X之后，能够封禁掉所有W指向Y的所有后门（或者后门是弱的，也可以解决）
       + 是我要把伪关系断掉，而不是把真关系断掉——那么之后，对于每一个给定的x我就可以知道了
       + √条件独立（统计这么叫）——做模型推断的一个必要假设，这个性质的意思是我保证我给你的x是信息充分的，我给你的特征是包含了病人在这个治疗中所需要的病理的相关全部信息；
       + √病人是否接受治疗和结果是独立的，结果值是被病理指标唯一决定（在没有引入噪声的时候），给定x之后Y0,Y1定了；（噪声会影响），但是医生是否治疗是不影响的
     + 不能做到一个人同时吃药+不吃药——用平均因果作用，他要研究目的
       + 为什么要把p的维数给成那么大——受众人群越小的时候，我们越能知道具体到每一个小群体的治疗效果好不好
9. **逆概率加权**
10. 给x降维，一个维度离我很近，另一个维度离我很远，但是这代表因果关系吗？
    + 不应该用空间距离之类判断，而是应该通过propensity这种，来判断对treatment的概率分布有没有影响
    + $e(x)$，引入propensity，分成好几个
    + **√核心目标：**要算的是一个条件期望，给定的条件是$X_i$，现在的问题是什么呢？条件是一部分是已知的，另一部分是反事实，要估计反事实的效果——怎么估计
      + 这篇文章给了两个baseline：观测值逼近理论值
        + 普通做法，把我的观测取一个平均就好了
        + 但是，因为我们想求期望的东西我们是观测不到的
        + 1. 逆概率加权，我们怎么把我的观测值，反向表示？？？（听一下这段的录音很有用）
    + 能不能把x压成f(x)——一个降维的思想，propensity score
      + 分条带
      + 我的核心问题在于我x和t之间的联系断不掉（就是那个propensity）——这样我把所有propensity相似的分成条带，3-4个条带，当然这个东西也是要估的——是怎么导致出来x和t的关系
      + double robust两个地方都有误差，用一些tricks把两个部分的误差绑定到一起，如果一个误差能够被很好的估计，那么整体就得到好的东西
11. 两个baseline combine起来了
    1. 逆概率加权
       + 给权重，之后归一$e(x)/（1-e(x))$的那个公式，修正权重——使得每个观测样本的权重变了
    2. 回归
12. 逆概率加权
    1. 样本分布的不均匀、不平衡
       + 通过前面乘一个权重，让样本最后平衡（就是分布权重的修正）
       + 但是我本来是4个样本，这样看起来我的总个变成8了——之后有一个standard 方法，让加权的总权还是4
    2. 我产生了一个虚拟的分布，使得这个虚拟分布是均衡的
    3. 就是2.2.1 那个weighted estimation
    4. 缺点——$e(x_i)$是要估计的，只能用非参的方法来估（论文里说的）；写成这种比例的形式的时候，肯定趋近于0或者1的时候，很难得到有效的非参解——这就是为什么这个方法不是很有效
       + assumption 6 overlap 给了一个上下界

## 论文部分

### 论文引入

1. 解决的点：
   1. 数据点很少
   2. 数据维数很高
2. 就估线性——最简单的方程——能体现出一些比较简单的效果
   + assumption 2 linearity
   + 逆加权只要求光滑就可以了，不要求线性；维数相当大的时候，没法估计$e(x_i)$
   + 更多怀疑是那个overlap的假设，调一调，两个分布之间调成一样？
3. 没吃药的人的线性系数是知道的，可以直接迁移到t中吗？从平均意义上是一样的，但是怎么求呢？
   + ols 希望知道它的系数$\beta_c$，后面就可以套用了
4. lasso和岭回归都是为了outlier 病态问题？使它更加稳定
   + 用lasso是lasso能做到变量选择
   + lasso更有可能那个椭圆交在坐标轴上，这样会更倾向交在棱形的点上，这样就可能去掉一些变量
   + 岭回归只能降低权重，但是不能把变量删掉，因为是圆和椭圆的切点
   + 为什么绝对值不能大
     + 绝对值大了之后就不robust了
   + 有些病态的矩阵，x稍微变化一点，y就变得特别大；但是加了一些xxx是想让这个更稳了，岭回归和lasso结合？elastic net
5. 噪声很有可能得到很多非常弱的伪关系

### 具体实现方法

#### 1. weighted

1. $Y^{obs}$ 拟没有treat的观察效果
2. 做权重调整（软估计）但是一定要有overlap
3. 不同要求，有的假设强要求就低（线性）；另一个假设弱，overlap

#### 2. 2.3部分

1. 剩下的弱关系能不能用权重的方法联系起来呢？就要证误差是多少
2. 不是线性的部分，也可能是导致噪声的部分，希望把噪声的分布给分离出来$\epsilon = Y_i(0) - X_i \beta_c$
3. 很多个点的期望叠到原来的上面
4. 还分析了直接使用regression会怎么样？
5. 方法
   1. 先搞一个elastic net，所有控制组里的东西进行一个线性，稳定性，去掉弱噪声——得到$\beta_c$
   2. 问题：如何选$\gamma_i$，误差都写在这了，直接用让误差最小的方法来选$\gamma_i$
   3. 他希望做到$\sqrt{n}$依照概率p收敛（consistent）
   4. 但是没说$n_c^{-\frac{2}{3}}$，估计是跟收敛速度有一定关系
6. 后面就开始放飞自我了
7. overlap就是交叠问题
   1. 我必须有一个交叠
   2. 修正之后真实的误差和标准的误差到底有多大，这个误差的分布是什么样的
      + 发现这个模型的误差是可以估计的，除以个什么，就可以变成n（0，1）这种

#### 3. 实验部分

1. 社会学中样本很小的情况
2. 9组数据23个特征，看哪些有用
3. 统计没有可以调的开源的库，没那么多可以用的东西





## 问题

1. $\mathcal{O}$





